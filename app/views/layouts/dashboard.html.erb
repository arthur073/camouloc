<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title> Camouloc </title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
	<%= csrf_meta_tag %>
	<%= favicon_link_tag "/favicon.ico" %>
	<%= stylesheet_link_tag "bootstrap", "ionicons", "AdminLTE.min", "skin-blue.min", "custom-dashboard", "ionicons.min", "font-awesome.min", "jquery.atwho.min"  %>
    <%= javascript_include_tag "jquery.min", "Chart.min", "validator.min" %>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    </head>


    <body class="hold-transition skin-blue sidebar-mini">
        <div class="wrapper">

         <!-- Main Header -->
          <header class="main-header">

            <!-- Logo -->
            <a href="index2.html" class="logo">
              <!-- mini logo for sidebar mini 50x50 pixels -->
              <span class="logo-mini"><b>C</b></span>
              <!-- logo for regular state and mobile devices -->
              <span class="logo-lg"><b>Camouloc</b></span>
            </a>

            <!-- Header Navbar -->
            <nav class="navbar navbar-static-top" role="navigation">
              <!-- Sidebar toggle button-->
              <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                <span class="sr-only">Toggle navigation</span>
              </a>
              <!-- Navbar Right Menu -->
              <div class="navbar-custom-menu">
                <ul class="nav navbar-nav">

                  <!-- User Account Menu -->
                  <li class="dropdown user user-menu">
                    <!-- Menu Toggle Button -->
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                      <!-- The user image in the navbar-->
                      <%= image_tag(current_user.image, :alt => "User image", :class => "user-image white-border") %>
                      <!-- hidden-xs hides the username on small devices so only the image appears. -->
                      <span class="hidden-xs"><%= current_user.nom %></span>
                    </a>
                    <ul class="dropdown-menu">
                      <!-- The user image in the menu -->
                      <li class="user-header">
                        <%= image_tag(current_user.image, :alt => "User image", :class => "img-circle white-border-big") %>
                        <p>
                          <%= current_user.nom %>
                          <small>Member since <%= current_user.created_at.strftime('%b %e') %> </small>
                        </p>
                      </li>
                      <!-- Menu Footer-->
                      <li class="user-footer">
                        <div class="pull-left">
                          <%= link_to "Profile", current_user, :class => "btn btn-default btn-flat" %>
                        </div>
                        <div class="pull-right">
                          <%= link_to "Sign out", signout_path, :class => "btn btn-default btn-flat" %>
                        </div>
                      </li>
                    </ul>
                  </li>
                  <!-- Control Sidebar Toggle Button -->
                  <li>
                    <a href="#" data-toggle="control-sidebar"><i class="fa fa-gears"></i></a>
                  </li>
                </ul>
              </div>
            </nav>
          </header>
          <!-- Left side column. contains the logo and sidebar -->
          <aside class="main-sidebar">

            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar">

              <!-- Sidebar user panel (optional) -->
              <div class="user-panel">
                <div class="pull-left image">
                  <%= image_tag(current_user.image, :alt => "User image", :class => "img-circle white-border") %>
                </div>
                <div class="pull-left info">
                  <p><%= current_user.nom %></p>
                  <!-- Status -->
                  <a href="#"><i class="fa fa-circle text-success"></i> Online</a>
                </div>
              </div>

              <!-- Sidebar Menu -->
              <ul class="sidebar-menu">
                <li class="header">MENU</li>
                <!-- Optionally, you can add icons to the links -->
                <li id="flatshare_link"><%= link_to "<i class='fa fa-home'></i> <span>My Flatshare</span>".html_safe, Coloc.find(current_user.coloc_id) %></li>
				<li id="user_link" ><%= link_to "<i class='fa fa-user'></i> <span>My profile</span>".html_safe, current_user %></li>
				<li id="expense_link" ><%= link_to "<i class='fa fa-money'></i> <span>Expenses</span>".html_safe, add_expense_path(:id => current_user.coloc.id) %></li>
              </ul><!-- /.sidebar-menu -->
            </section>
            <!-- /.sidebar -->
          </aside>

          <!-- Content Wrapper. Contains page content -->
          <div class="content-wrapper">
			<div class="alert-wrapper">
                <% flash.each do |type, content| %>
                    <% if content.respond_to?('each') 
                        content.each do |item| %>
                            <%= render 'layouts/alert', 
                                type: type,
                                content: item %>
                        <% end %>
                    <% else %>
                        <%= render 'layouts/alert', 
                                type: type,
                                content: content %>
                    <% end %>

                <% end %>
			</div>

                <%= yield %>
          </div><!-- /.content-wrapper -->

          <!-- Main Footer -->
          <footer class="main-footer">
            <!-- To the right -->
            <div class="pull-right hidden-xs">
                All rights reserved.
            </div>
            <!-- Default to the left -->
            <strong>Copyright &copy; <%= Date.today.strftime("%Y") %> <a href="#">Camouloc</a></strong> 
          </footer>

          <!-- Control Sidebar -->
          <aside class="control-sidebar control-sidebar-dark">
            <!-- Create the tabs -->
            <ul class="nav nav-tabs nav-justified control-sidebar-tabs">
                  <li><a href="#flatshare-settings" data-toggle="tab"><i class="fa fa-home"></i></a></li>
                  <li><a href="#profile-settings" data-toggle="tab"><i class="fa fa-user"></i></a></li>
            </ul>   
            <!-- Tab panes -->
            <div class="tab-content">
              <!-- Home tab content -->
              <div class="tab-pane active" id="flatshare-settings">
               <h3 class="control-sidebar-heading">Flatshare settings</h3>                
				<%= form_for Coloc.find(current_user.coloc_id), :html => { "data-toggle" => "validator", :id => "editform_flatshare" } do |f| %>
					<label class="control-sidebar-subheading">
					  Name
					</label>
					<div class="form-group has-feedback">
			            <%= f.text_field :nom, :class => "form-control", :placeholder => "Flatshare name", :required => true, "data-minlength" => "3", 
							"data-remote" => "/verifycoloc?prev_name="+Coloc.find(current_user.coloc_id).nom, :name => "nom", "data-remote-error" => "This flatshare name already exists" %>
						<span class="glyphicon glyphicon-home form-control-feedback"></span>
						<div class="help-block with-errors"></div>
					</div>		
				  <%= f.submit "Save", :class => "btn btn-primary btn-block btn-flat"%>
				<% end %>
              </div><!-- /.tab-pane -->
              <div class="tab-pane" id="profile-settings">
               <h3 class="control-sidebar-heading">Profile settings</h3>
				<%= form_for current_user, :html => { "data-toggle" => "validator", :id => "editform_user" } do |f| %>
					<label class="control-sidebar-subheading">
					  Name
					</label>
					<div class="form-group has-feedback">
						<%= f.text_field :nom, :class => "form-control", :placeholder => "Name", "data-minlength" => "6", "required" => true %>
						<span class="glyphicon glyphicon-user form-control-feedback"></span>
						<div class="help-block with-errors"></div>
					</div>
					<label class="control-sidebar-subheading">
					  Email
					</label>
					<div class="form-group has-feedback">
						<%= f.email_field :email, :id => "edit_email_field", :class => "form-control", :placeholder => "Email", :required => true, "data-minlength" => "6",
							"data-remote" => "/verifyuser?prev_email="+current_user.email, :name => "email", "data-remote-error" => "A user with this email already exists" %>
						<span class="glyphicon glyphicon-envelope form-control-feedback"></span>
						<div class="help-block with-errors"></div>
					</div>		
					<label class="control-sidebar-subheading">
					  Password
					</label>
					<div class="form-group has-feedback">
						<%= f.password_field :password, :class => "form-control", :placeholder => "Password", :required => true, "data-minlength" => "8" %>
						<span class="glyphicon glyphicon-lock form-control-feedback"></span>
						<div class="help-block with-errors"></div>
					</div>
					<div class="form-group has-feedback">
						<%= f.password_field :password_confirmation, :class => "form-control", :placeholder => "Retype password", :required => true, "data-minlength" => "8" %>
						<span class="glyphicon glyphicon-lock form-control-feedback"></span>
						<span class="help-block">Minimum of 8 characters</span>
						<div class="help-block with-errors"></div>
					</div>			
				  <%= f.submit "Save", :class => "btn btn-primary btn-block btn-flat"%>
				<% end %>
              </div><!-- /.tab-pane -->
            </div>
          </aside><!-- /.control-sidebar -->
          <!-- Add the sidebar's background. This div must be placed
               immediately after the control sidebar -->
          <div class="control-sidebar-bg"></div>
        </div><!-- ./wrapper -->
    


        <%= javascript_include_tag "bootstrap.min", "app.min" %>
		
		
		<script>
		
			if (window.location.pathname.indexOf("colocs") > -1) {
				$("#flatshare_link").addClass("active");
			} else if (window.location.pathname.indexOf("users") > -1) {			
				$("#user_link").addClass("active");
			} else if (window.location.pathname.indexOf("penses") > -1) {
				$("#expense_link").addClass("active");
			}
			
			$('#editform_flatshare').validator();
			$('#editform_user').validator();

		</script>
    </body>
</html>
